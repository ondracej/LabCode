clear;
n=1;
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_28-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=2; 
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_30-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=3;
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_01-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=4;
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_04-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=5;
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_05-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=6; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0009_06-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

%%%%%%%%%%% w016

n=7; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0016_05-08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1


n=8; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0016_06-08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1


n=9; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0016_08-08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1
%%%%%%%%% w0021
n=10; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0021_20_08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=11; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0021_21-08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=12; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0021_23-08';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

%%%%%%%%% w0041
n=13; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0041-05-01-2022';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=14; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0041-06-01-2022';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=15; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0041-07-01-2022';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

n=16; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0041-08-01-2022';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1

%%%%%%% w043
n=17; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_w0043-23-12-2021';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=0; %%%%%% juv=0, adult=1


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% adults
n=18; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_02-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1


n=19; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_03-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=20; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_05-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=21; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_06-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=22; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_07-04';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1



n=23; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_26_03';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=24; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-00_31-03';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1




n=25; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-94_07-06';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=26; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-94_08-06';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=27; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-94_28-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=28; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-94_29_05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=29; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_72-94_31-05';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1





n=30; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_73-03_09_03';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=31; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_73-03_11_03';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1

n=32; %%%%%%%%
fname='G:\Hamed\zf\P1_16chnl_EEG\EEGdata_corr_paper\stage_stat_sleep_stages_73-03 14_03';%%%%%%%%
[filepath,name,ext] = fileparts(fname);
stages_data=load(fname);
transition(n,:)=stages_data.REM_nREM_transitions;
adult(n)=1; %%%%%% juv=0, adult=1


%% visualization to be modified 
transitions_juv_mean=mean(transition(~logical(adult),:));
transitions_adult_mean=mean(transition(logical(adult),:));
transitions_juv_err=std(transition(~logical(adult),:))/sqrt(sum(~logical(adult)));
transitions_adult_err=std(transition(logical(adult),:))/sqrt(sum(logical(adult)));
figure
set(gcf, 'Position',  [600, 500, 646, 170])
x=1:12;

hold on
er = errorbar(x-.14,transitions_juv_mean,transitions_juv_err,transitions_juv_err);    
er.Color = [0 0 0];                            
er.LineStyle = 'none'; 
er = errorbar(x+.14,transitions_adult_mean,transitions_adult_err,transitions_adult_err);    
er.Color = [0 0 0];                            
er.LineStyle = 'none';  

b=bar(x,[transitions_juv_mean; transitions_adult_mean], 'FaceColor',[1 .5 .5],'EdgeColor',[1 .7 .7]); 
b(2).FaceColor = [.5 .5 1];
b(2).EdgeColor = [.7 .7 1];
xlabel('Time (h)')
ylim([0 ...
    ceil(max([transitions_adult_mean; transitions_juv_mean],[],'all'))+10]);
% floor(min([transitions_juv_mean; transitions_adult_mean],[],'all')-.1*max([transitions_adult_mean; transitions_juv_mean],[],'all'))
xlim([0 13])